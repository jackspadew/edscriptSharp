# ハッシュ値算出処理に関する概念の整理

## 前置き

<u>ストレッチング中のソルト付与処理</u>について、それがソルトという概念とは異なるという結論に至った。
ここでは、SaltとStretchingの（一般的な）解釈をまとめ、
一般的な概念を踏まえた上で独自機能であるLyeの概念をまとめる。

## Salt

ハッシュ値を計算する前にInputBytesにSaltBytesを付与すること。

## Stretching

算出されたハッシュ値を元にハッシュ値算出処理を行うこと。それを指定回数[^1]まで行うこと。

[^1]: 以下、`Stretching指定回数`と表現する。

## SaltとStretchingとStretching指定回数に対する解釈

ここに述べる解釈は、<u>一般的なハッシュ値算出処理</u>においては重要ではないが、
後述するLyeの概念を取り入れる際に問題になった。

- 一般的に`Stretching`と`Salt`の概念は独立していて、`Stretching`中に`Salt`処理は行われない。（多分）
- 一般的に`Stretching`はハッシュ値算出の繰り返しが2回以上の場合を指す。（多分）
  - だが、<u>`Stretching`の概念の無いハッシュ値</u>が<u>`Stretching指定回数`が1回のハッシュ</u>という感覚はある。
  - つまり、`Stretching指定回数`が1回のハッシュ値は算出可能である。
  - また、`Stretching指定回数`が1回の時の出力は<u>`Stretching`を行っていないハッシュ値</u>と完全に同一である事が期待される。【要件A】
- 一般的に`Stretching指定回数`が0回という考え方は無い。（多分）

## Lye (独自の概念)

Stretching中のハッシュ値算出前に(`Salt`のように)LyeBytesを付与すること。

### Lyeを取り入れた場合のStretching指定回数と処理内容

0. 0回の場合はthrow
1. 1回の場合
  - `Stretching`のコードは実行されない。【要件A1】
2. 2回以上の場合
  - `Stretching`のコードは実行される。
  - `Stretching`の処理の中で`Lye`付与の処理が呼ばれる。

使用者の直観的な期待である【要件A】を守るために【要件A1】を守る必要がある。

## 要点だけまとめ

`Salt`と`Lye`の概念は独立させること。
`Salt`は1回目の算出時にのみ扱うこと。
`Lye`は1回目の算出時には扱わないこと。
`Lye`は（2回目以降の算出を行う）`Stretching`処理中にのみ扱う。
